package com.dev.air.module.impl.exploit;

import com.dev.air.event.impl.packet.PacketReceiveEvent;
import com.dev.air.event.impl.packet.PacketSendEvent;
import com.dev.air.event.impl.packet.update.PreMotionEvent;
import com.dev.air.module.api.Category;
import com.dev.air.module.api.Module;
import com.dev.air.module.api.annotation.ModuleInfo;
import com.dev.air.util.packet.PacketUtil;
import net.lenni0451.asmevents.event.Target;
import net.minecraft.network.Packet;
import net.minecraft.network.play.client.C01PacketChatMessage;
import net.minecraft.network.play.client.C03PacketPlayer;
import net.minecraft.network.play.client.C03PacketPlayer.C04PacketPlayerPosition;
import net.minecraft.network.play.client.C03PacketPlayer.C06PacketPlayerPosLook;

import java.util.ArrayList;

@ModuleInfo(name = "Blink", description = "Temporarily stops sending packets to make you teleport", category = Category.EXPLOIT)
public class BlinkMod extends Module {

    ArrayList<Packet> packet = new ArrayList<Packet>();
    int currentPacket = 0;

    @Target
    public void onPacketSend(PacketSendEvent e) {
        if (mc.player == null) return;

        if(e.getPacket().getClass().getSimpleName().startsWith("C")){
            packet.add(e.getPacket());
            e.setCancelled(true);
        }
    }

    @Override
    public void onDisable() {
        if(packet.size() > currentPacket) {
            for(int i = 0; packet.size() > currentPacket; i++) {
                PacketUtil.sendNo(packet.get(currentPacket++));
            }
        }
        packet.clear();
        currentPacket = 0;
    }

}
